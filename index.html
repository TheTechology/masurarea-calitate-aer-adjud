<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Calitate Aer și Temperatură - Adjud</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gradient-to-br from-green-200 to-blue-300 min-h-screen flex flex-col items-center justify-center p-6">

  <div class="bg-white rounded-3xl shadow-xl p-8 w-full max-w-4xl text-center space-y-10">

    <header>
      <h1 class="text-4xl font-bold text-gray-800">Monitorizare Calitate Aer și Temperatură</h1>
      <p class="mt-2 text-gray-600 text-lg">Orașul Adjud, județul Vrancea</p>
    </header>

    <!-- Descriere proiect -->
    <section class="text-left text-gray-700">
      <h2 class="text-2xl font-semibold mb-2">Despre proiect</h2>
      <p class="mb-4">
        Acest proiect educativ este realizat cu sprijinul <strong>Asociației Grupul Verde</strong>, având ca scop monitorizarea calității aerului și a temperaturii în timp real în orașul Adjud.
        Inițiativa face parte din programul nostru de educație pentru mediu și tehnologie, care încurajează tinerii să contribuie activ la protejarea mediului prin soluții digitale.
      </p>
      <p class="mb-4">
        În mod deosebit, apreciem contribuția elevului <strong>Novac Giorgio</strong>, în vârstă de 14 ani, de la <em>Colegiul Tehnic "Gheorghe Balș" Adjud</em>, care a contribuit la dezvoltarea și testarea funcțională a platformei.
        Giorgio este un exemplu de implicare și pasiune pentru tehnologie și ecologie!
      </p>
    </section>

    <!-- Widget Calitate Aer -->
    <section>
      <h2 class="text-2xl font-semibold text-gray-700 mb-2">Calitatea Aerului în Adjud</h2>
      <span id="city-aqi-container" class="block my-4"></span>
    </section>

    <!-- Temperatură -->
    <section>
      <h2 class="text-2xl font-semibold text-gray-700 mb-2">Temperatura actuală</h2>
      <p class="text-lg">Temperatură:
        <span id="temperatureValue" class="font-bold text-blue-700">--</span> °C
      </p>
      <p id="weatherStatus" class="text-md text-gray-600">Condiții: --</p>
      <div class="w-full h-64 mt-4">
        <canvas id="temperatureChart"></canvas>
      </div>
    </section>

    <!-- Footer -->
    <footer class="pt-6 border-t border-gray-200 text-sm text-gray-600">
      © 2025 Asociația Grupul Verde • Dezvoltat de copii și tineri din comunitatea Adjud
    </footer>

  </div>

  <!-- Script AQICN (calitate aer) -->
  <script type="text/javascript" charset="utf-8">
    (function(w, d, t, f) {
      w[f] = w[f] || function(c, k, n) {
        s = w[f], k = s['k'] = (s['k'] || (k ? ('&k=' + k) : '')); 
        s['c'] = c = (c instanceof Array) ? c : [c]; 
        s['n'] = n = n || 0; 
        L = d.createElement(t), e = d.getElementsByTagName(t)[0]; 
        L.async = 1; 
        L.src = '//feed.aqicn.org/feed/' + (c[n].city) + '/' + (c[n].lang || '') + '/feed.v1.js?n=' + n + k; 
        e.parentNode.insertBefore(L, e);
      };
    })(window, document, 'script', '_aqiFeed');
  </script>

  <script type="text/javascript" charset="utf-8">
    _aqiFeed({
      container: "city-aqi-container",
      city: "adjud",
      lang: "ro"
    });
  </script>

  <!-- Script temperatură -->
  <script>
    const temperatureValue = document.getElementById('temperatureValue');
    const weatherStatus = document.getElementById('weatherStatus');
    const ctx = document.getElementById('temperatureChart').getContext('2d');

    const tempChart = new Chart(ctx, {
      type: 'line',
      data: {
        labels: [],
        datasets: [{
          label: 'Temperatura (°C)',
          data: [],
          borderColor: '#2563eb',
          backgroundColor: 'rgba(37, 99, 235, 0.3)',
          borderWidth: 2,
          tension: 0.3,
          fill: true
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: {
            suggestedMin: -10,
            suggestedMax: 40
          }
        }
      }
    });

    async function fetchTemperature() {
      try {
        const response = await fetch(
          'https://api.openweathermap.org/data/2.5/weather?q=Adjud,ro&units=metric&appid=345bfb1800c59f8f650f0159b1ad1a71'
        );
        const data = await response.json();
        const temp = data.main.temp;
        const cond = data.weather[0].description;

        temperatureValue.textContent = temp.toFixed(1);
        weatherStatus.textContent = `Condiții: ${cond}`;

        const now = new Date().toLocaleTimeString();
        tempChart.data.labels.push(now);
        tempChart.data.datasets[0].data.push(temp);
        if (tempChart.data.labels.length > 10) {
          tempChart.data.labels.shift();
          tempChart.data.datasets[0].data.shift();
        }
        tempChart.update();
      } catch (error) {
        console.error('Eroare API:', error);
        weatherStatus.textContent = "Nu s-au putut obține datele.";
      }
    }

    fetchTemperature();
    setInterval(fetchTemperature, 60000); // actualizare la 1 minut
  </script>

</body>
</html>
